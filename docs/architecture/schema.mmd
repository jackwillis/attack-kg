%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#4A90A4', 'lineColor': '#666'}}}%%

erDiagram
    TECHNIQUE {
        string attackId PK "T1110.003"
        string name "Password Spraying"
        string description
        string detection
        string url
        string version
    }

    GROUP {
        string attackId PK "G0016"
        string name "APT29"
        string description
        string url
        string[] aliases
        string[] contributors
    }

    SOFTWARE {
        string attackId PK "S0154"
        string name "Cobalt Strike"
        string type "Malware | Tool"
        string description
        string url
        string[] platforms
        string[] aliases
    }

    MITIGATION {
        string attackId PK "M1032"
        string name "Multi-factor Authentication"
        string description
        string url
    }

    CAMPAIGN {
        string attackId PK "C0027"
        string name
        string description
        datetime firstSeen
        datetime lastSeen
        string url
    }

    TACTIC {
        string attackId PK "TA0006"
        string name "Credential Access"
        string shortname "credential-access"
    }

    DATA_SOURCE {
        string attackId PK "DS0002"
        string name "User Account"
        string description
    }

    DATA_COMPONENT {
        string stixId PK
        string name "Authentication Logs"
        string description
    }

    DETECTION_STRATEGY {
        string attackId PK "DET0039"
        string name
        string description
    }

    ANALYTIC {
        string attackId PK "AN0110"
        string name
        string description
        string[] platforms
        string[] logSources
    }

    %% Core relationships
    GROUP ||--o{ TECHNIQUE : uses
    SOFTWARE ||--o{ TECHNIQUE : uses
    CAMPAIGN ||--o{ TECHNIQUE : uses
    CAMPAIGN }o--|| GROUP : attributedTo

    %% Defensive relationships
    MITIGATION ||--o{ TECHNIQUE : mitigates
    DETECTION_STRATEGY ||--o{ TECHNIQUE : detects
    DETECTION_STRATEGY ||--o{ ANALYTIC : hasAnalytic

    %% Technique hierarchy
    TECHNIQUE ||--o{ TECHNIQUE : subtechniqueOf
    TECHNIQUE }o--o{ TACTIC : tactic
    TECHNIQUE }o--o{ DATA_SOURCE : dataSource

    %% Data source hierarchy
    DATA_SOURCE ||--o{ DATA_COMPONENT : hasComponent
